#summary Recommended procedure for updating MySQL

= Use Soup =

It's no longer necessary to perform the steps listed here as long as you use "sudo soup" to perform updates.  

= Introduction =

Updating the Ubuntu MySQL packages can be problematic due to autossh port forwarding and a bug in our current version of ELSA.  Here's the recommended procedure to ensure a smooth update.

= Procedure =

  # Stop all relevant services:
{{{
sudo service nsm stop
sudo service syslog-ng stop
sudo service apache2 stop
sudo pkill autossh
sudo pkill perl
}}}
  # Check the process listing and verify all nsm/syslog-ng/apache/autossh/perl processes have stopped:
{{{
ps aux
}}}
  # Install the MySQL updates.  Other updates (such as securityonion-snorby) may require MySQL to be running, so only update the MySQL server packages as shown below.  If you're prompted concerning locally modified config files, keep your currently-installed version.  This is especially important in the case of ELSA log nodes where we've changed the MySQL port from its default of 3306 to 50000.
{{{
sudo apt-get update && sudo apt-get install mysql-server mysql-server-core-5.5 mysql-server-5.5
}}}
  # Reboot:
{{{
sudo reboot
}}}