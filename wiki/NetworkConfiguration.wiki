#summary Network Configuration for Production Deployment

= Disabling the graphical Network Manager and configuring networking from the command line =

NOTE! You may lose network connectivity during this process! Have a backup plan if attempting over SSH!<br>
<br>
Stop Network Manager:<br>
{{{sudo /etc/init.d/network-manager stop}}}<br>
<br>
Prevent Network Manager from starting at next boot:<br>
{{{sudo mv /etc/init/network-manager.conf /etc/init/network-manager.conf.DISABLED}}}<br>
<br>
Configure your network interfaces in /etc/network/interfaces.  You'll want a management interface (using either static IP *or* DHCP) and one or more interfaces dedicated to sniffing (no IP address).  NIC offloading functions such as tso, gso, and gro should be disabled to ensure that Snort/Suricata get an accurate view of the traffic:<br>
{{{
auto lo
iface lo inet loopback

# Management interface DHCP
auto eth0
iface eth0 inet dhcp
  post-up for i in rx tx sg tso ufo gso gro lro; do ethtool -K $IFACE $i off; done

# OR if using STATIC IP instead of DHCP
auto eth0
iface eth0 inet static
  address 192.168.1.14
  gateway 192.168.1.1
  netmask 255.255.255.0
  network 192.168.1.0
  broadcast 192.168.1.255
  post-up for i in rx tx sg tso ufo gso gro lro; do ethtool -K $IFACE $i off; done

# Connected to TAP or SPAN port for all Internet traffic
auto eth1
iface eth1 inet manual
  up ifconfig $IFACE -arp up
  up ip link set $IFACE promisc on
  down ip link set $IFACE promisc off
  down ifconfig $IFACE down
  post-up for i in rx tx sg tso ufo gso gro lro; do ethtool -K $IFACE $i off; done

}}}

You may also want to set the RX buffer size in the post-up command like this:
{{{
post-up ethtool -G $IFACE rx 4096; for i in rx tx sg tso ufo gso gro lro; do ethtool -K $IFACE $i off; done
}}}
Note that 4096 is just an example and your NIC may have a different maximum rx size.  To determine the maximum rx setting for your NIC:
{{{
ethtool -g ethX
}}}

If necessary, configure DNS in /etc/resolv.conf.<br>
<br>
Restart networking:<br>
{{{sudo /etc/init.d/networking restart}}}<br>
<br>
If you already had sensors running on these interfaces, you should restart them:<br>
{{{sudo nsm_sensor_ps-restart}}}<br>
<br>
For more information, please see:<br>
<a href="https://help.ubuntu.com/community/NetworkConfigurationCommandLine/Automatic">https://help.ubuntu.com/community/NetworkConfigurationCommandLine/Automatic</a><br>
<a href="http://securityonion.blogspot.com/2011/10/when-is-full-packet-capture-not-full.html">http://securityonion.blogspot.com/2011/10/when-is-full-packet-capture-not-full.html</a>
}}}