#summary Frequently Asked Questions

= What's the recommended procedure for installing Security Onion? =

<a href="http://code.google.com/p/security-onion/wiki/Installation">http://code.google.com/p/security-onion/wiki/Installation</a>

= What do I need to do if I'm behind a proxy? =

<a href="http://code.google.com/p/security-onion/wiki/Proxy">http://code.google.com/p/security-onion/wiki/Proxy</a>

= How do I install Security Onion updates? =

<a href="http://code.google.com/p/security-onion/wiki/Upgrade">http://code.google.com/p/security-onion/wiki/Upgrade</a>

= Why do apt-get and the Update Manager show tcl8.5 as held back? =
<a href="http://code.google.com/p/security-onion/wiki/tcl">http://code.google.com/p/security-onion/wiki/tcl</a>

= What is the root password? =

Like other Ubuntu-based distributions, there is no root password.  Your default user account has been given sudo permissions.  Graphical utilities requesting administrative access should prompt for password; enter your user password. Command-line utilities that require administrative access can be prefixed with "sudo". For example, to add a user:<br>
sudo adduser mynewuseraccount

= What is the Squert password? =

Squert authenticates against the Sguil username database, so you should be able to login to Squert using the same username/password you use to login to Sguil.

= What is the MySQL password? =

Security Onion has a blank MySQL password to allow the NSMnow administration scripts to add/delete sensors properly.  MySQL only allows connections from localhost.  Once you've run through Setup and configured your sensors, you might want to change the MySQL password.

= Why is my disk filling up? =
Sguil uses daemonlogger to record full packet captures to disk.  These pcaps are stored in /nsm/sensor_data/NAME_OF_SENSOR/dailylogs/.  There is an hourly cronjob at /etc/cron.d/sensor-clean that should delete old pcaps when the disk reaches 90% of capacity.  It's important to properly size your disk storage so that you avoid filling the disk to 100% before the next hourly purge runs.<br>

= Why does Security Onion use UTC? =
Security Onion uses UTC because that is the recommended/required setting for Sguil:<br>
<a href="http://osdir.com/ml/security.sguil.general/2008-09/msg00003.html">http://osdir.com/ml/security.sguil.general/2008-09/msg00003.html</a><br>
<a href="https://forums.snort.org/forums/linux/topics/barnyard-sguil-time-problem">https://forums.snort.org/forums/linux/topics/barnyard-sguil-time-problem</a><br>
<br>
Trying to use a non-UTC timezone can result in the following:<br>
- Time zones that have daylight saving time have a one-hour time warp twice a year.  This manifests itself in Sguil not being able to pull transcripts for events within that one-hour time period.  This is avoided by using UTC, since there is no daylight saving time.<br>
- Something similar can happen on a daily basis under certain conditions.  If there is a discrepancy between the OS timezone and the Sguil UTC settings, then Sguil will be unable to pull transcripts for events in a window of time around midnight coinciding with the timezone's offset from UTC.<br>
Additionally, UTC comes in quite handy when you have sensors in different time zones and/or are trying to correlate events with other systems or teams.<br>
The Setup wizard (/usr/local/bin/setup) does the following to set the OS and all services to UTC:
{{{
echo "Etc/UTC" | sudo tee /etc/timezone
sudo dpkg-reconfigure --frontend noninteractive tzdata
sudo service rsyslog restart
sudo cp /etc/localtime /var/ossec/etc/localtime
sudo chown root:ossec /var/ossec/etc/localtime
sudo service ossec restart
}}}

= What to I need to modify in order to have the log files stored on a different mount point? =

There are two ways to do this:<br>
- Mount a separate drive to /nsm.  This can be done in the Ubuntu installer or after installation is complete.<br>
OR<br>
- Make /nsm a symlink to the new logging location.  If you do this, you'll need to do the following to avoid AppArmor issues:<br>
 - go to /etc/apparmor.d<br>
 - edit usr.sbin.mysqld, copy the nsm line, and change /nsm to the new location<br>
 - edit usr.sbin.tcpdump, copy the nsm line, and change /nsm to the new location<br>
 - service apparmor restart<br>

= How do I configure Sguil to send alerts via email? =
<a href="http://nsmwiki.org/Sguil_FAQ#Can_sguil_page_me_when_it_sees_a_particular_alert.3F">http://nsmwiki.org/Sguil_FAQ#Can_sguil_page_me_when_it_sees_a_particular_alert.3F</a>

= How do I change the fonts in the Sguil client? =

In the Sguil client, click the File menu and then go to "Change Font".  You can change both the Standard and Fixed fonts.  Fonts are a personal issue, but I like the following:<br>
Standard: Liberation Sans, size 8<br>
Fixed: Liberation Mono, size 8<br>

= How do I boot Security Onion to text mode (CLI instead of GUI)? =
In /etc/default/grub, change this line:<br>
{{{
GRUB_CMDLINE_LINUX_DEFAULT="splash quiet"
}}}
to:<br>
{{{
GRUB_CMDLINE_LINUX_DEFAULT="text"
}}}

Then run:<br>
{{{
sudo update-grub
}}}

For more information, please see:<br>
<a href="http://ubuntuforums.org/showthread.php?t=1690118">http://ubuntuforums.org/showthread.php?t=1690118</a>

= How do I get Security Onion to recognize more than 4GB of RAM? =
Install the PAE kernel as described here:<br>
<a href="https://help.ubuntu.com/community/EnablingPAE">https://help.ubuntu.com/community/EnablingPAE</a>

= How do I disable the graphical Network Manager and configuring networking from the command line? =

<a href="http://code.google.com/p/security-onion/wiki/NetworkConfiguration">http://code.google.com/p/security-onion/wiki/NetworkConfiguration</a>

= Why can't I upgrade past version 20110628? = 

If your /etc/nsm/securityonion.conf says:<br>
{{{
VERSION=20110628
}}}
<br>
and if running the upgrade says:<br>
{{{
Your Security Onion installation is up to date.
}}}
<br>
then a previous upgrade from 20110628 to 20110709 was interrupted.  This upgrade changed the config file format from spaces to equal signs.  Edit the VERSION in /etc/nsm/securityonion.conf as follows:<br>
{{{
VERSION=20110709
}}}
<br>
and then re-run the upgrade.<br>

= How do I receive an email when my sensor stops receiving traffic? =
<a href="http://securityonion.blogspot.com/2011/11/how-do-i-receive-email-when-my-sensor.html">http://securityonion.blogspot.com/2011/11/how-do-i-receive-email-when-my-sensor.html</a><br>
<a href="http://securityonion.blogspot.com/2011/11/follow-up-on-ossec-alerts-for-packet.html">http://securityonion.blogspot.com/2011/11/follow-up-on-ossec-alerts-for-packet.html</a><br>

= I'm running Security Onion in a VM and the screensaver is using lots of CPU.  How do I change/disable the screensaver? =
  # Click Applications.<br>
  # Click Settings.<br>
  # Click Screensaver.<br>
  # Screensaver Preferences window appears.  Click the Mode dropdown and select "Disable Screen Saver" or "Blank Screen Only".<br>
  # Close the Screensaver Preferences window.<br>

= I'm currently running Snort.  How do I switch to Suricata? =
First, make sure you're running the latest version of Security Onion.  Then run the following commands:
{{{
sudo nsm_sensor_ps-stop --only-snort-alert
sudo sed -i 's|ENGINE=snort|ENGINE=suricata|g' /etc/nsm/securityonion.conf
sudo /usr/local/bin/pulledpork_update.sh 
}}}

= How do I add a new user to Sguil? =
You can add new Sguil user accounts with the following (when prompted, enter "securityonion" as the server name):<br>
{{{
sudo /usr/local/sbin/nsm_server_user-add
}}}

= I get periodic MySQL crashes and/or error code 24 "out of resources" when searching in Sguil.  How do I fix that? =
{{{
sudo nsm_server_ps-stop
sudo service mysql stop
# Edit /etc/mysql/my.cnf and add the following in the [mysqld] section (without the # comment sign):
# open-files-limit        = 4096
sudo service mysql start
sudo nsm_server_ps-start
}}}
For more information, please see:<br>
<a href="http://nsmwiki.org/Sguil_FAQ#I.27m_seeing_error_code_24_from_MySQL._How_do_I_fix_that.3F">http://nsmwiki.org/Sguil_FAQ#I.27m_seeing_error_code_24_from_MySQL._How_do_I_fix_that.3F</a><br>

= How can I install FreeNX on Security Onion? =
[FreeNX Installing FreeNX on Security Onion Wiki Article] - Contributed by Lance Honer

= How can I add and test local rules? = 
[AddingLocalRules Adding local rules and testing them with scapy]

= Why is the Snorby dashboard not displaying correctly?  Why do I have to restart the Sensor Cache job periodically? =
First, make sure you're running the latest version of Security Onion.  Then check this thread on the mailing list to see if you're missing an index on one of the MySQL tables:<br>
<a href="https://groups.google.com/d/topic/security-onion/zugnYFXh7Do/discussion">https://groups.google.com/d/topic/security-onion/zugnYFXh7Do/discussion</a><br>
If so, run the following command:
{{{
    mysql -uroot -e 'create index index_timestamp_cid_sid on event (timestamp, cid, sid);'
}}}

= Why does Snort segfault every day at 7:01 AM? =
7:01 AM is the time of the daily PulledPork rules update.  If you're running Snort with the VRT ruleset, this includes updating the SO rules.  There is a known issue when running Snort with the VRT ruleset and updating the SO rules:<br>
<a href="https://groups.google.com/d/topic/pulledpork-users/1bQDkh3AhNs/discussion">https://groups.google.com/d/topic/pulledpork-users/1bQDkh3AhNs/discussion</a><br>
After updating the rules, Snort is restarted, and the segfault occurs in the OLD instance of Snort (not the NEW instance).  Therefore, the segfault is merely a nuisance log entry and can safely be ignored.

= What's the difference between a "server" and a "sensor"? =
box<br>
Definition: A physical or virtual machine running the Security Onion operating system.<br>
<br>
server<br>
Definition: A set of processes that receive data from sensors and allow analysts to see and investigate that data.  The set of processes includes sguild, mysql, and snorby.  The server is also responsible for ruleset management.<br>
Naming convention: The collection of server processes has a server name separate from the hostname of the box.  Security Onion always sets the server name to "securityonion".<br>
Configuration files: /etc/nsm/securityonion/<br>
Controlled by:  /usr/local/sbin/nsm_server <br>
<br>
server box<br>
Definition: A machine running the server processes.  May optionally be running sensor processes.<br>
Example 1: User runs Quick Setup on machine with hostname securityonion and two ethernet interfaces.  Setup creates a server and two sensors (securityonion-eth0 and securityonion-eth1).<br>
Example 2: User runs Advanced Setup and chooses Server.  Setup creates a server only (no sensor processes).<br>
<br>
sensor<br>
Definition: A set of processes listening on a network interface.  The set of processes currently includes Snort/Suricata, daemonlogger, sancp, argus, pads, httpry, and bro (although this is in constant flux as we add new capabilities and find better tools for existing capabilities).<br>
Naming convention: $HOSTNAME-$INTERFACE<br>
Configuration files: /etc/nsm/$HOSTNAME-$INTERFACE/<br>
Example: sensor1-eth0<br>
Controlled by:  /usr/local/sbin/nsm_sensor<br>
<br>
sensor box<br>
Definition: A machine having one or more sensors that transmit to a central server.  Does not run server processes.  Pulls ruleset from server box.  (In some contexts, I refer to this a slave pulling rules from the master.)<br>
Example: A machine named sensor1 having sensors sensor1-eth0 and sensor1-eth1.<br>

= How do I configure the OS to be able to send email (like cronjobs)? =
{{{
# Install mail server
sudo apt-get -y install mailutils
# Configure mail server
sudo dpkg-reconfigure exim4-config
}}}

= Where do I send questions/problems/suggestions? =

The Security Onion mailing list is provided by Google Groups.  Please join the mailing list here:<br>
<a href="http://groups.google.com/group/security-onion">http://groups.google.com/group/security-onion</a><br>
You can then send your question/problem/suggestion via the Google Groups web interface OR by sending an email to:<br>
<a href="mailto:security-onion@googlegroups.com">security-onion@googlegroups.com</a><br>
In order to be as effective and efficient as possible, please consider the following when posing your question/problem to the group:<br>
<a href="http://www.chiark.greenend.org.uk/~sgtatham/bugs.html">http://www.chiark.greenend.org.uk/~sgtatham/bugs.html</a>