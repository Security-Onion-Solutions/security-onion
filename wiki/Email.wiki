#summary Configuring email for alerting and reporting
= Introduction =

This page describes how to configure email for alerting and reporting.  Applications such as Snorby, Sguil, and OSSEC have their own mail configuration and don't rely on a mail server in the OS itself.  However, you may still want to install a mail server in the OS so that you can get daily emails from the sostat script.

= How do I configure Snorby to send emails? =
You'll need to modify a few files (on the master server). First, modify /usr/local/share/snorby/config/snorby_config.yml and change the "domain" setting in the Production section to be the FQDN of your Snorby server. Next, modify /usr/local/share/snorby/config/initializers/mail_config.rb as needed for your mail server.

= How do I configure Sguil to send alerts via email?<br> =
Modify /etc/nsm/securityonion/sguild.email (on the master server) as needed and restart sguild:
{{{
sudo nsm_server_ps-restart
}}}
You can then verify the email configuration by looking at the top of sguild's log file:
{{{
head -20 /var/log/nsm/securityonion/sguild.log
}}}
For more information, please see:<br>
<a href="http://nsmwiki.org/Sguil_FAQ#Can_sguil_page_me_when_it_sees_a_particular_alert.3F">http://nsmwiki.org/Sguil_FAQ#Can_sguil_page_me_when_it_sees_a_particular_alert.3F</a>

= How do I configure OSSEC to send emails? =
Modify /var/ossec/etc/ossec.conf as follows:
{{{
  <global>
    <email_notification>yes</email_notification>
    <email_to>YourUsername@YourDomain.com</email_to>
    <smtp_server>YourMailRelay.YourDomain.com</smtp_server>
    <email_from>ossec@YourDomain.com</email_from>
    <email_maxperhour>100</email_maxperhour>
  </global>
}}}
Then restart OSSEC:
{{{
sudo service ossec restart
}}}

= How can I get an email alert when my sensor stops seeing traffic? =
[SensorStopsSeeingTraffic]

= How do I configure the OS itself to send emails? =
Install the mail server:
{{{
sudo apt-get -y install mailutils
}}}
Configure the mail server:
{{{
sudo dpkg-reconfigure exim4-config
}}}
Once you've done that and verified that it works, you might want to create a daily cronjob to execute /usr/bin/sostat and email you the output:
{{{
# /etc/cron.d/sostat
#
# crontab entry to run sostat and email its output

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
EMAIL=YourUsername@YourDomain.com

01 12    * * *   root    HOSTNAME=`hostname`; /usr/bin/sostat | mail -s "$HOSTNAME stats" $EMAIL
}}}

= How do I configure Bro to send emails? =
Edit the MailTo directive in /usr/local/etc/broctl.cfg.  Then update and restart Bro:
{{{
sudo broctl install
sudo broctl restart
}}}